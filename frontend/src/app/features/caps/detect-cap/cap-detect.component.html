<div class="card max-w-md mx-auto p-6 shadow-lg bg-white dark:bg-gray-900 rounded-lg space-y-6">
  <h2 class="text-2xl font-bold text-center text-purple-600">
    Détection de Bouchon
  </h2>

  <!-- ID -->
  <div>
    <label class="block mb-1 font-medium text-gray-700 dark:text-gray-300">ID Bouchon</label>
    <div class="flex">
      <span class="px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded-l-md text-sm text-gray-800 dark:text-white">cap-</span>
      <input type="text" [(ngModel)]="idNumber" placeholder="001" class="form-input flex-1 rounded-r-md dark:bg-gray-800 dark:text-white" />
    </div>
  </div>

  <!-- Mode -->
  <div class="flex gap-4 text-sm text-gray-700 dark:text-gray-200">
    <label><input type="radio" [(ngModel)]="mode" value="upload" /> Image</label>
    <label><input type="radio" [(ngModel)]="mode" value="realtime" /> Temps réel</label>
  </div>

  <!-- Upload -->
  <div *ngIf="mode === 'upload'">
    <input #file type="file" accept="image/*" class="form-input w-full dark:bg-gray-800 dark:text-white" />
  </div>

  <!-- Realtime -->
  <div *ngIf="mode === 'realtime'" class="space-y-3">
    <video #video autoplay class="w-full rounded-md border dark:border-gray-700" [hidden]="!cameraOn"></video>
    <div class="flex gap-2">
      <button *ngIf="!cameraOn" (click)="openCamera()" class="btn btn-primary w-full">Ouvrir Caméra</button>
      <button *ngIf="cameraOn" (click)="stopCamera()" class="btn btn-secondary w-full">Fermer Caméra</button>
    </div>
  </div>

  <canvas #canvas hidden></canvas>

  <!-- Analyse -->
  <button (click)="startAnalyse()" [disabled]="loading" class="btn btn-accent w-full mt-4">
    {{ loading ? "Analyse en cours..." : "Démarrer l’analyse" }}
  </button>

  <!-- Save -->
  <button (click)="saveResult()" [disabled]="saving || !result?.predictions?.length" class="btn btn-success w-full mt-2">
    {{ saving ? "Sauvegarde..." : "Sauvegarder le résultat" }}
  </button>

  <!-- Résultat -->
  <div *ngIf="result" class="bg-gray-100 dark:bg-gray-800 p-4 rounded-md mt-4">
    <h3 class="text-lg font-semibold text-gray-700 dark:text-white mb-2">Prédictions</h3>
    <pre class="text-sm text-gray-800 dark:text-gray-200 max-h-60 overflow-auto">{{ result?.predictions | json }}</pre>
  </div>
</div>
